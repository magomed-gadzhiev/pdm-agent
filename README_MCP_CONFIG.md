# Конфигурация MCP сервера для тестирования веб-приложения

Этот документ описывает, как настроить и использовать конфигурацию MCP сервера для тестирования веб-приложения.

## Структура конфигурации

Конфигурация MCP сервера хранится в файле `config.json` в корне проекта:

```json
{
  "pdm": {
    "url": "http://localhost:8001/mcp",
    "headers": {
      "Authorization": "Bearer OyIs7e0WD2iOgWJOQoBcOL0GsznaHtfjxC3oE-Lj9Y9LVzs4nhJqwR4M2mEvRJuG"
    }
  }
}
```

## Как изменить конфигурацию

1. **URL сервера**: Измените значение `url`, если ваш MCP сервер работает на другом адресе или порту.

2. **Токен авторизации**: Замените значение в заголовке `Authorization`, если у вас другой токен доступа.

## Использование конфигурации в коде

Для удобного доступа к конфигурации создан модуль `mcp_config.py`, который предоставляет следующие функции:

### `get_mcp_config()`

Возвращает полную конфигурацию MCP сервера:

```python
from mcp_config import get_mcp_config

config = get_mcp_config()
print(config)
# Вывод: {'url': 'http://localhost:8001/mcp', 'headers': {...}}
```

### `get_mcp_url()`

Возвращает URL MCP сервера:

```python
from mcp_config import get_mcp_url

url = get_mcp_url()
print(url)
# Вывод: http://localhost:8001/mcp
```

### `get_mcp_headers()`

Возвращает заголовки для запросов к MCP серверу:

```python
from mcp_config import get_mcp_headers

headers = get_mcp_headers()
print(headers)
# Вывод: {'Authorization': 'Bearer OyIs7e0WD2iOgWJOQoBcOL0GsznaHtfjxC3oE-Lj9Y9LVzs4nhJqwR4M2mEvRJuG'}
```

## Пример использования с requests

Вот пример того, как использовать конфигурацию для выполнения запросов к MCP API:

```python
import requests
from mcp_config import get_mcp_url, get_mcp_headers

# Получаем конфигурацию
url = get_mcp_url()
headers = get_mcp_headers()

# Выполняем GET запрос
response = requests.get(url, headers=headers)

if response.status_code == 200:
    print("Успешное соединение с MCP сервером!")
    data = response.json()
    print(data)
else:
    print(f"Ошибка: {response.status_code}")
```

## Тестирование соединения

Для проверки соединения с MCP сервером вы можете использовать скрипт `test_mcp_connection.py`:

```bash
python test_mcp_connection.py
```

Этот скрипт:
1. Проверяет соединение с MCP сервером
2. Получает список бизнес-процессов
3. Выводит информацию о доступных процессах

## Настройка для разных окружений

Для разных окружений (разработка, тестирование, продакшн) вы можете:

1. **Создать отдельные конфигурационные файлы**: `config.dev.json`, `config.test.json`, `config.prod.json`

2. **Использовать переменные окружения**: Модифицировать `mcp_config.py` для чтения конфигурации из переменных окружения

3. **Использовать Django settings**: Если проект использует Django, можно интегрировать конфигурацию в `settings.py`

## Безопасность

⚠️ **ВАЖНО**: Не коммитьте токены авторизации в публичные репозитории! 

- Добавьте `config.json` в `.gitignore`
- Используйте переменные окружения для чувствительных данных
- Для продакшн окружения используйте безопасные методы хранения секретов

## Устранение неполадок

Если у вас возникают проблемы с соединением:

1. **Проверьте URL сервера**: Убедитесь, что MCP сервер запущен и доступен по указанному адресу
2. **Проверьте токен авторизации**: Убедитесь, что токен действителен и не истек
3. **Проверьте сеть**: Убедитесь, что нет проблем с сетевым подключением
4. **Проверьте логи сервера**: Посмотрите логи MCP сервера на наличие ошибок

## Дополнительная информация

Для более подробной информации о MCP API обратитесь к документации MCP сервера или свяжитесь с администратором системы.